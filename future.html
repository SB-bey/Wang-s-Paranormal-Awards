<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>世界灵异事件大赏 (AI增强版)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* 深色背景 */
            color: #e2e8f0; /* 浅色文字 */
        }
        /* 自定义滚动条样式 */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #2d3748; /* 滚动条轨道颜色 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #4a5568; /* 滚动条滑块颜色 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* 滚动条滑块悬停颜色 */
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #6366f1;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-left: 8px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="p-4 md:p-8 lg:p-12">
    <div class="max-w-4xl mx-auto bg-gray-800 rounded-xl shadow-2xl overflow-hidden">
        <header class="bg-gray-900 p-6 md:p-8 text-center rounded-t-xl">
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600 mb-4">
                世界灵异事件大赏
            </h1>
            <p class="text-lg md:text-xl text-gray-300">
                探索那些至今未解的神秘现象与超自然传说 (AI增强版)
            </p>
        </header>

        <section class="p-6 md:p-8 lg:p-10">
            <p class="text-base md:text-lg leading-relaxed mb-6 text-gray-200">
                自古以来，人类对未知和超自然现象的探索从未停止。本页面将带您回顾几个令人费解的灵异事件，一同感受它们所带来的震撼与谜团。新增AI生成功能，为您带来更多奇思妙想！
            </p>

            <div id="events-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8 justify-items-center">
                <div class="event-card bg-gray-700 rounded-lg shadow-lg p-6 flex flex-col items-center text-center transform hover:scale-105 transition-transform duration-300 max-w-sm w-full">
                    <h2 class="event-title text-2xl md:text-3xl font-bold text-purple-300 mb-4">王廷香老师的预知：PPT事件</h2>
                    <img src="https://placehold.co/400x250/334155/94a3b8?text=神秘老师" alt="王廷香的预知" class="w-full h-auto rounded-md mb-4 object-cover">
                    <p class="event-description text-gray-200 text-sm md:text-base leading-relaxed">
                        一位学生在课堂上打瞌睡，却被王廷香多次翻白眼提醒。下课后，王廷香竟直接询问：“你昨晚是不是去做PPT去了？”这令人震惊的预知能力，让学生和周围的人都感到毛骨悚然，至今无法解释老师是如何得知学生前一晚毫不存在的秘密活动的。
                    </p>
                </div>

                <div class="event-card bg-gray-700 rounded-lg shadow-lg p-6 flex flex-col items-center text-center transform hover:scale-105 transition-transform duration-300 max-w-sm w-full">
                    <h2 class="event-title text-2xl md:text-3xl font-bold text-pink-300 mb-4">王廷香老师的预知：偷鸡事件</h2>
                    <img src="https://placehold.co/400x250/334155/94a3b8?text=神秘老师" alt="王廷香老师的预知 - 偷鸡事件" class="w-full h-auto rounded-md mb-4 object-cover">
                    <p class="event-description text-gray-200 text-sm md:text-base leading-relaxed">
                        同样是王廷香，面对课堂上打瞌睡的学生，她直接发问：“你昨晚是不是去偷鸡了？”老师精准地道出了学生前一晚不存在的“秘密行动”，其洞察力之深令人不寒而栗。这起事件再次证明了王老师超乎寻常的预知能力，让人对她的身份和力量充满好奇。
                    </p>
                </div>

                <div class="event-card bg-gray-700 rounded-lg shadow-lg p-6 flex flex-col items-center text-center transform hover:scale-105 transition-transform duration-300 max-w-sm w-full">
                    <h2 class="event-title text-2xl md:text-3xl font-bold text-purple-300 mb-4">王廷香的语言之谜：“资本”</h2>
                    <img src="https://placehold.co/400x250/334155/94a3b8?text=语言异象" alt="王廷香老师的语言之谜" class="w-full h-auto rounded-md mb-4 object-cover">
                    <p class="event-description text-gray-200 text-sm md:text-base leading-relaxed">
                        王廷香对“资本”一词的运用，超越了正常人类常识与逻辑的边界。无论语境如何，她总能将这个词以一种令人费解的方式嵌入对话。这种独特的语言模式，如同某种无形的力量在操控她的表达，让人在困惑之余，不禁怀疑这是否是某种深层意识或异次元信息在她言语中的投射，至今无人能洞悉其奥秘。
                    </p>
                </div>

                <div class="event-card bg-gray-700 rounded-lg shadow-lg p-6 flex flex-col items-center text-center transform hover:scale-105 transition-transform duration-300 max-w-sm w-full">
                    <h2 class="event-title text-2xl md:text-3xl font-bold text-teal-300 mb-4">王廷香与消失的粉笔</h2>
                    <img src="https://placehold.co/400x250/334155/94a3b8?text=粉笔疑云" alt="王廷香与消失的粉笔" class="w-full h-auto rounded-md mb-4 object-cover">
                    <p class="event-description text-gray-200 text-sm md:text-base leading-relaxed">
                        据多名学生回忆，王廷香老师在课堂上使用粉笔时，常有粉笔在其指尖凭空消失的现象。有时是一整根，有时是刚写下几个字就仅剩粉笔头。更令人不解的是，消失的粉笔从未在教室任何角落被找到，仿佛被某种异次元空间吞噬。有人猜测这与她常提及的“资本运作”有关，或许粉笔被转化成了某种无形资产。
                    </p>
                </div>
            </div>
        </section>

        <section class="p-6 md:p-8 lg:p-10 bg-gray-850 rounded-lg shadow-xl mt-8 border border-purple-500/50">
            <h2 class="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-sky-400 to-cyan-300 mb-6 text-center">
                ✨ AI创作灵异事件
            </h2>
            <div class="text-center mb-6">
                <button id="generate-event-button"
                        class="bg-gradient-to-r from-sky-500 to-cyan-500 hover:from-sky-600 hover:to-cyan-600 text-white font-bold py-3 px-8 rounded-lg shadow-lg transform hover:scale-105 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:ring-opacity-75 flex items-center justify-center mx-auto">
                    <span id="generate-event-button-text">尝试让AI创作一个新的“王廷香”灵异事件</span>
                    <span id="generate-event-loader" class="loader" style="display: none;"></span>
                </button>
            </div>
            <div id="new-event-container" class="mt-6">
                </div>
             <p id="ai-event-status" class="text-center text-sm text-gray-400 mt-4"></p>
        </section>


        <section class="p-6 md:p-8 lg:p-10 bg-gray-700 rounded-b-xl mt-8">
            <h2 class="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-500 mb-6 text-center">
                假评论区
            </h2>

            <div class="bg-gray-800 p-6 rounded-lg shadow-inner mb-8">
                <h3 class="text-xl md:text-2xl font-semibold text-gray-200 mb-4">发表您不会公开的看法</h3>
                <form onsubmit="return false;" class="space-y-4">
                    <div>
                        <label for="comment-name" class="block text-gray-300 text-sm font-bold mb-2">
                            您的昵称:
                        </label>
                        <input type="text" id="comment-name" placeholder="匿名"
                               class="shadow appearance-none border rounded-lg w-full py-3 px-4 bg-gray-600 text-gray-100 leading-tight focus:outline-none focus:shadow-outline focus:border-purple-500 transition-colors duration-200">
                    </div>
                    <div>
                        <label for="comment-text" class="block text-gray-300 text-sm font-bold mb-2">
                            您的评论:
                        </label>
                        <textarea id="comment-text" rows="5" placeholder="分享您的想法或经历... 或让AI帮您写一条！"
                                  class="shadow appearance-none border rounded-lg w-full py-3 px-4 bg-gray-600 text-gray-100 leading-tight focus:outline-none focus:shadow-outline focus:border-purple-500 transition-colors duration-200 resize-y"></textarea>
                    </div>
                    <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4">
                        <button type="submit"
                                class="w-full sm:w-auto bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transform hover:scale-105 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-purple-400 focus:ring-opacity-75">
                            不提交评论
                        </button>
                        <button type="button" id="generate-comment-button"
                                class="w-full sm:w-auto bg-gradient-to-r from-teal-500 to-emerald-500 hover:from-teal-600 hover:to-emerald-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transform hover:scale-105 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-75 flex items-center justify-center">
                            <span id="generate-comment-button-text">✨ AI生成评论</span>
                            <span id="generate-comment-loader" class="loader" style="display: none;"></span>
                        </button>
                    </div>
                </form>
                <p id="ai-comment-status" class="text-center text-sm text-gray-400 mt-4"></p>
            </div>

            <div class="space-y-6">
                <h3 class="text-xl md:text-2xl font-semibold text-gray-200 mb-4">假评论</h3>
                <div class="bg-gray-800 p-5 rounded-lg shadow-md border border-gray-600">
                    <div class="flex items-center mb-3">
                        <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-lg mr-3">A</div>
                        <div><p class="font-bold text-blue-300">韩国大兵</p><p class="text-gray-400 text-sm">2025年5月24日</p></div>
                    </div>
                    <p class="text-gray-200 leading-relaxed">我发誓说深夜加班时听见她对着空会议室说"资本"，隔天会议桌就长出类似证券代码的霉斑。最恐怖的当属上月失踪的实习生，监控显示他最后时刻疯狂敲击键盘，屏幕上的Word文档正以每分钟五千字速度自动生成"资本"字符。救援队破门时只找到件衬衫，纽扣全被替换成了微型道琼斯指数表盘，领口处用血写着"流通即诅咒"。🈲</p>
                </div>
                <div class="bg-gray-800 p-5 rounded-lg shadow-md border border-gray-600">
                    <div class="flex items-center mb-3">
                        <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white font-bold text-lg mr-3">B</div>
                        <div><p class="font-bold text-green-300">平安是福1</p><p class="text-gray-400 text-sm">2025年5月23日</p></div>
                    </div>
                    <p class="text-gray-200 leading-relaxed">你们还没看懂吗？这分明是五鬼运财的阴契反噬！ 老城隍庙的算命瞎子摸着起卦的铜钱突然抽搐，那女人命格里根本压不住“资本”二字自带的七杀煞气。知道为啥每次说完这个词她口红都会掉色吗？那是被看不见的黄金秤砣在啃食阳寿！🙏🏻🙏🏻🙏🏻</p>
                </div>
                <div class="bg-gray-800 p-5 rounded-lg shadow-md border border-gray-600">
                    <div class="flex items-center mb-3">
                        <div class="w-10 h-10 bg-red-500 rounded-full flex items-center justify-center text-white font-bold text-lg mr-3">C</div>
                        <div><p class="font-bold text-red-300">不吃香菜</p><p class="text-gray-400 text-sm">2025年5月22日</p></div>
                    </div>
                    <p class="text-gray-200 leading-relaxed">你们不觉得偷鸡很好好笑么，我服了 什么人才能想到偷鸡这样的词语，太灵异了！🆘像鸡这种生物她都觉得有人偷说明她是鸡梦女呀❗❗我滴妈说明她是喜欢鸡的，这种热爱动物的人值得保护！给这个大袜子点赞👍🏻👍🏻</p>
                </div>
                <div class="bg-gray-800 p-5 rounded-lg shadow-md border border-gray-600">
                    <div class="flex items-center mb-3">
                        <div class="w-10 h-10 bg-yellow-500 rounded-full flex items-center justify-center text-white font-bold text-lg mr-3">D</div>
                        <div><p class="font-bold text-yellow-300">逻辑探索者88</p><p class="text-gray-400 text-sm">2025年5月25日</p></div>
                    </div>
                    <p class="text-gray-200 leading-relaxed">关于粉笔消失事件，我有一个大胆的假设：王老师可能掌握了微型虫洞技术。粉笔并非消失，而是被瞬间传送到了另一个维度，或者，更贴近“资本”主题——它们被传送到了一个专门存放“教学资源储备”的秘密金库。每次提及“资本”，她可能就在进行一次传送操作！🤯 #细思极恐 #量子物理学解释一切</p>
                </div>
            </div>
        </section>
        <footer class="bg-gray-900 p-6 md:p-8 text-center rounded-b-xl mt-8">
            <p class="text-gray-400 text-sm md:text-base">
                灵异事件投稿: picaagp@gmail.com
            </p>
            <p class="text-gray-500 text-xs mt-2">
                © 2025 灵异事件收集站
            </p>
        </footer>
    </div>

    <script>
        // API Key - leave empty if using gemini-2.0-flash or imagen-3.0-generate-002 without a key
        const apiKey = ""; 

        // DOM Elements
        const generateCommentButton = document.getElementById('generate-comment-button');
        const generateCommentButtonText = document.getElementById('generate-comment-button-text');
        const generateCommentLoader = document.getElementById('generate-comment-loader');
        const commentTextarea = document.getElementById('comment-text');
        const aiCommentStatus = document.getElementById('ai-comment-status');

        const generateEventButton = document.getElementById('generate-event-button');
        const generateEventButtonText = document.getElementById('generate-event-button-text');
        const generateEventLoader = document.getElementById('generate-event-loader');
        const newEventContainer = document.getElementById('new-event-container');
        const eventsGrid = document.getElementById('events-grid');
        const aiEventStatus = document.getElementById('ai-event-status');

        // --- AI Comment Generation ---
        generateCommentButton.addEventListener('click', async () => {
            generateCommentButton.disabled = true;
            generateCommentButtonText.textContent = 'AI思考中...';
            generateCommentLoader.style.display = 'inline-block';
            aiCommentStatus.textContent = '';

            try {
                const eventCards = document.querySelectorAll('.event-card');
                let eventContext = "我正在浏览一个关于以下灵异事件的网页：\n";
                eventCards.forEach((card, index) => {
                    const title = card.querySelector('.event-title').textContent.trim();
                    const description = card.querySelector('.event-description').textContent.trim().substring(0, 100) + "..."; // Limit description length
                    eventContext += `${index + 1}. ${title} - ${description}\n`;
                });

                const prompt = `${eventContext}\n请你扮演一个对此类神秘事件深感兴趣的网友，写一条不超过100字的评论，风格要口语化、略带夸张或悬疑色彩，可以是对这些事件的感想、猜测，或者分享一个“听说”来的相关小故事。`;
                
                const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { contents: chatHistory };
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('API Error:', errorData);
                    throw new Error(`API请求失败，状态码: ${response.status}. ${errorData?.error?.message || ''}`);
                }

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const generatedText = result.candidates[0].content.parts[0].text;
                    commentTextarea.value = generatedText.trim();
                    aiCommentStatus.textContent = 'AI评论已生成！';
                } else {
                    console.error('Unexpected API response structure:', result);
                    throw new Error('未能从API获取有效评论内容。');
                }

            } catch (error) {
                console.error('生成评论时出错:', error);
                commentTextarea.value = "抱歉，AI生成评论失败，请稍后再试。\n错误：" + error.message;
                aiCommentStatus.textContent = 'AI评论生成失败。';
            } finally {
                generateCommentButton.disabled = false;
                generateCommentButtonText.textContent = '✨ AI生成评论';
                generateCommentLoader.style.display = 'none';
            }
        });

        // --- AI Event Generation ---
        generateEventButton.addEventListener('click', async () => {
            generateEventButton.disabled = true;
            generateEventButtonText.textContent = 'AI构思中...';
            generateEventLoader.style.display = 'inline-block';
            aiEventStatus.textContent = '';
            // newEventContainer.innerHTML = ''; // Clear previous generated event if any

            try {
                const existingEvents = Array.from(document.querySelectorAll('.event-card')).slice(0, 2); // Take first 2 as examples
                let examples = "";
                if (existingEvents.length > 0) {
                    examples = "请参考以下成功案例的风格：\n";
                    existingEvents.forEach((card, index) => {
                        const title = card.querySelector('.event-title').textContent.trim();
                        const description = card.querySelector('.event-description').textContent.trim();
                        examples += `案例${index + 1}：【${title}】${description}\n`;
                    });
                }

                const prompt = `请你扮演一个灵异故事创作者，创作一个新的、关于“王廷香老师”的简短灵异事件。故事应该包含一个吸引人的【标题】和一段100-150字的【描述】。风格要神秘、悬疑，略带一丝校园怪谈的感觉。${examples}\n请将新创作的事件以JSON对象格式返回，包含 "title" (字符串) 和 "description" (字符串) 两个键。`;

                const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = {
                    contents: chatHistory,
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: "OBJECT",
                            properties: {
                                "title": { "type": "STRING" },
                                "description": { "type": "STRING" }
                            },
                            required: ["title", "description"]
                        }
                    }
                };
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('API Error:', errorData);
                    throw new Error(`API请求失败，状态码: ${response.status}. ${errorData?.error?.message || ''}`);
                }
                
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    
                    const rawJsonText = result.candidates[0].content.parts[0].text;
                    let generatedEvent;
                    try {
                        generatedEvent = JSON.parse(rawJsonText);
                    } catch (parseError) {
                         console.error('JSON解析错误:', parseError, "原始文本:", rawJsonText);
                         throw new Error('AI返回的数据格式不正确，无法解析为JSON。');
                    }


                    if (generatedEvent && generatedEvent.title && generatedEvent.description) {
                        appendNewEvent(generatedEvent.title, generatedEvent.description);
                        aiEventStatus.textContent = '新的灵异事件已由AI创作完成！';
                    } else {
                        console.error('Unexpected JSON structure from API:', generatedEvent);
                        throw new Error('AI返回的数据缺少标题或描述。');
                    }
                } else {
                    console.error('Unexpected API response structure for event generation:', result);
                    throw new Error('未能从API获取有效事件内容。');
                }

            } catch (error) {
                console.error('生成事件时出错:', error);
                newEventContainer.innerHTML = `<p class="text-red-400 text-center">抱歉，AI生成事件失败：${error.message}</p>`;
                aiEventStatus.textContent = 'AI事件生成失败。';
            } finally {
                generateEventButton.disabled = false;
                generateEventButtonText.textContent = '尝试让AI创作一个新的“王廷香”灵异事件';
                generateEventLoader.style.display = 'none';
            }
        });

        function appendNewEvent(title, description) {
            const eventCardHTML = `
                <div class="bg-gray-700 rounded-lg shadow-lg p-6 flex flex-col items-center text-center transform hover:scale-105 transition-transform duration-300 max-w-sm w-full mx-auto">
                    <h2 class="text-2xl md:text-3xl font-bold text-cyan-300 mb-4">${title} (✨AI创作)</h2>
                    <img src="https://placehold.co/400x250/2c3e50/ecf0f1?text=AI生成事件" alt="${title}" class="w-full h-auto rounded-md mb-4 object-cover">
                    <p class="text-gray-200 text-sm md:text-base leading-relaxed">${description}</p>
                </div>
            `;
            // Prepend to the new-event-container so latest is on top, or append to eventsGrid
            // For this demo, let's put it in its own container. If you want to add to the grid:
            // eventsGrid.insertAdjacentHTML('beforeend', eventCardHTML);
            newEventContainer.innerHTML = eventCardHTML; // Replace content of newEventContainer
        }

    </script>
</body>
</html>
